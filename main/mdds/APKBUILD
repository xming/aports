# Contributor: Sören Tempel <soeren+alpine@soeren-tempel.net>
# Contributor: Timo Teräs <timo.teras@iki.fi>
# Maintainer: Timo Teräs <timo.teras@iki.fi>
pkgname=mdds
pkgver=1.1.0
_commit=ef218ea3d0c7e6e8cc1dc2b3a36149dd6f431155
pkgrel=0
pkgdesc="Multi-dimentional data index algorithm"
url="https://gitlab.com/mdds/mdds"
arch="noarch"
license="MIT"
depends=""
depends_dev=""
makedepends="automake autoconf"
install=""
subpackages="$pkgname-dev $pkgname-doc"
source="$pkgname-$pkgver.tar.gz::https://gitlab.com/$pkgname/$pkgname/repository/archive.tar.gz?ref=$pkgver
	"

_builddir="$srcdir"/$pkgname-$pkgver-$_commit
prepare() {
	local i
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done

	./autogen.sh || return 1
}

build() {
	cd "$_builddir"
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--sysconfdir=/etc \
		--docdir="/usr/share/doc/$pkgname" \
		--mandir=/usr/share/man \
		--localstatedir=/var \
		|| return 1
	make || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" install || return 1
	install -d 755 "$pkgdir"/usr/lib
	mv "$pkgdir"/usr/share/pkgconfig "$pkgdir"/usr/lib/
}

md5sums="6d342a3dfd4543226fac809fe3de80fc  mdds-1.1.0.tar.gz"
sha256sums="457da61cb46947413d05bb6dc948f8d0e1cf4ec79b1d1013a5c1038b720eaec4  mdds-1.1.0.tar.gz"
sha512sums="e08af101cc9f1c54a3b957fa2bb0c833b31128914d33137d259c6b01f348d5c51a1d9691e8b0da1eee43e3d7bb6375d3ec80446d96cbecfe193b381a6e5cca8d  mdds-1.1.0.tar.gz"
